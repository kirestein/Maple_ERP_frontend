<div class="employee-view-container">
  <!-- Header com botão de voltar -->
  <div class="header-actions">
    <button mat-icon-button (click)="goBack()" class="back-button">
      <mat-icon>arrow_back</mat-icon>
    </button>
    <h1>Detalhes do Funcionário</h1>
  </div>

  <!-- Loading spinner -->
  @if (isLoading) {
  <div class="loading-container">
    <mat-spinner diameter="40"></mat-spinner>
    <p>Carregando dados do funcionário...</p>
  </div>
  }

  <!-- Error message -->
  @if (error && !isLoading) {
  <mat-card class="error-card">
    <mat-card-content>
      <div class="error-container">
        <mat-icon color="warn">error</mat-icon>
        <h2>{{ error }}</h2>
        <p>Verifique se o ID do funcionário está correto ou tente novamente.</p>
        <div class="error-actions">
          <button mat-button color="primary" (click)="loadEmployee()">
            <mat-icon>refresh</mat-icon>
            Tentar novamente
          </button>
          <button mat-button (click)="goBack()">
            <mat-icon>arrow_back</mat-icon>
            Voltar à lista
          </button>
        </div>
      </div>
    </mat-card-content>
  </mat-card>
  }

  <!-- Employee details -->
  @if (employee && !isLoading && !error) {
  <div class="employee-details">
    <!-- Foto e informações principais -->
    <mat-card class="main-info-card">
      <mat-card-content>
        <div class="main-info">
          <div class="photo-section">
            <div class="photo-container">
              <img 
                [src]="getPhotoUrl()" 
                [alt]="employee.fullName + ' - Foto'"
                (error)="onImageError($event)"
                class="employee-photo"
              />
            </div>
          </div>
          
          <div class="basic-info">
            <h1 class="employee-name">{{ employee.fullName }}</h1>
            <h2 class="employee-position">{{ employee.jobPosition || 'Cargo não informado' }}</h2>
            
            <div class="status-section">
              <mat-chip 
                [class]="getStatusChipClass()"
                class="status-chip"
              >
                {{ getStatusDisplay() }}
              </mat-chip>
            </div>

            <div class="quick-actions">
              <button mat-raised-button color="primary" (click)="generateBadge()">
                <mat-icon>badge</mat-icon>
                Gerar Crachá
              </button>
              <button mat-raised-button color="accent" (click)="generateDocument()">
                <mat-icon>description</mat-icon>
                Gerar Documento Contábil
              </button>
              <button mat-stroked-button color="primary" (click)="editEmployee()">
                <mat-icon>edit</mat-icon>
                Editar
              </button>
            </div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Informações pessoais -->
    <mat-card class="info-section">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>person</mat-icon>
          Informações Pessoais
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="info-grid">
          <div class="info-item">
            <label>Nome Completo:</label>
            <span>{{ employee.fullName || 'Não informado' }}</span>
          </div>
          <div class="info-item">
            <label>Nome para Crachá:</label>
            <span>{{ employee.tagName || 'Não informado' }}</span>
          </div>
          <div class="info-item">
            <label>Sobrenome para Crachá:</label>
            <span>{{ employee.tagLastName || 'Não informado' }}</span>
          </div>
          <div class="info-item">
            <label>Data de Nascimento:</label>
            <span>{{ formatDate(employee.birthday) }}</span>
          </div>
          <div class="info-item">
            <label>CPF:</label>
            <span>{{ formatCpf(employee.cpf) }}</span>
          </div>
          <div class="info-item">
            <label>RG:</label>
            <span>{{ employee.rg || 'Não informado' }}</span>
          </div>
          <div class="info-item">
            <label>Órgão Emissor RG:</label>
            <span>{{ employee.rgEmitter || 'Não informado' }}</span>
          </div>
          <div class="info-item">
            <label>Data Emissão RG:</label>
            <span>{{ formatDate(employee.rgEmissionDate) }}</span>
          </div>
          <div class="info-item">
            <label>Gênero:</label>
            <span>{{ employee.gender || 'Não informado' }}</span>
          </div>
          <div class="info-item">
            <label>Estado Civil:</label>
            <span>{{ employee.maritalStatus || 'Não informado' }}</span>
          </div>
          <div class="info-item">
            <label>Cor da Pele:</label>
            <span>{{ employee.skinColor || 'Não informado' }}</span>
          </div>
          <div class="info-item">
            <label>Naturalidade:</label>
            <span>{{ employee.naturalness || 'Não informado' }}</span>
          </div>
          <div class="info-item">
            <label>Nacionalidade:</label>
            <span>{{ employee.nationality || 'Não informado' }}</span>
          </div>
          <div class="info-item">
            <label>Escolaridade:</label>
            <span>{{ employee.graduation || 'Não informado' }}</span>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Informações de contato -->
    <mat-card class="info-section">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>contact_phone</mat-icon>
          Contato
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="info-grid">
          <div class="info-item">
            <label>E-mail:</label>
            <span>{{ employee.email || 'Não informado' }}</span>
          </div>
          <div class="info-item">
            <label>Telefone:</label>
            <span>{{ formatPhone(employee.phone) }}</span>
          </div>
          <div class="info-item">
            <label>Celular:</label>
            <span>{{ formatPhone(employee.mobile) }}</span>
          </div>
          <div class="info-item full-width">
            <label>Endereço:</label>
            <span>
              @if (employee.employeeAddress) {
                {{ employee.employeeAddress }}
                @if (employee.employeeAddressNumber) {
                  , {{ employee.employeeAddressNumber }}
                }
                @if (employee.employeeAddressComplement) {
                  , {{ employee.employeeAddressComplement }}
                }
                @if (employee.employeeNeighborhood) {
                  <br>{{ employee.employeeNeighborhood }}
                }
                @if (employee.employeeAddressCity || employee.employeeAddressState) {
                  <br>{{ employee.employeeAddressCity }}{{ employee.employeeAddressState ? ' - ' + employee.employeeAddressState : '' }}
                }
                @if (employee.cep) {
                  <br>CEP: {{ employee.cep }}
                }
              } @else {
                Não informado
              }
            </span>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Informações profissionais -->
    <mat-card class="info-section">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>work</mat-icon>
          Informações Profissionais
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="info-grid">
          <div class="info-item">
            <label>Cargo/Posição:</label>
            <span>{{ employee.jobPosition || 'Não informado' }}</span>
          </div>
          <div class="info-item">
            <label>Funções:</label>
            <span>{{ employee.jobFunctions || 'Não informado' }}</span>
          </div>
          <div class="info-item">
            <label>Departamento:</label>
            <span>{{ employee.department || 'Não informado' }}</span>
          </div>
          <div class="info-item">
            <label>Data de Admissão:</label>
            <span>{{ formatDate(employee.admissionDate) }}</span>
          </div>
          <div class="info-item">
            <label>Período de Trabalho:</label>
            <span>{{ employee.period || 'Não informado' }}</span>
          </div>
          <div class="info-item">
            <label>Vencimento do Contrato:</label>
            <span>{{ formatDate(employee.contractExpirationDate) }}</span>
          </div>
          <div class="info-item">
            <label>Horas Diárias:</label>
            <span>{{ employee.dailyHours || 'Não informado' }}</span>
          </div>
          <div class="info-item">
            <label>Horas Semanais:</label>
            <span>{{ employee.weeklyHours || 'Não informado' }}</span>
          </div>
          <div class="info-item">
            <label>Horas Mensais:</label>
            <span>{{ employee.monthlyHours || 'Não informado' }}</span>
          </div>
          <div class="info-item">
            <label>Aulas Semanais:</label>
            <span>{{ employee.weeklyClasses || 'Não informado' }}</span>
          </div>
          <div class="info-item">
            <label>Possui Acumulo:</label>
            <span>{{ employee.hasAccumulate ? 'Sim' : 'Não' }}</span>
          </div>
          @if (employee.hasAccumulate && employee.hasAccumulateCompany) {
          <div class="info-item">
            <label>Empresa do Acúmulo:</label>
            <span>{{ employee.hasAccumulateCompany }}</span>
          </div>
          }
          <div class="info-item">
            <label>Status:</label>
            <span>{{ employee.status || 'Não informado' }}</span>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Documentação -->
    <mat-card class="info-section">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>description</mat-icon>
          Documentação
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="info-grid">
          @if (employee.pisPasep) {
          <div class="info-item">
            <label>PIS/PASEP:</label>
            <span>{{ employee.pisPasep }}</span>
          </div>
          }
          @if (employee.ctps) {
          <div class="info-item">
            <label>CTPS:</label>
            <span>{{ employee.ctps }}{{ employee.ctpsSerie ? ' - Série: ' + employee.ctpsSerie : '' }}</span>
          </div>
          }
          @if (employee.voterTitle) {
          <div class="info-item">
            <label>Título de Eleitor:</label>
            <span>{{ employee.voterTitle }}</span>
          </div>
          }
          @if (employee.voterZone) {
          <div class="info-item">
            <label>Zona Eleitoral:</label>
            <span>{{ employee.voterZone }}</span>
          </div>
          }
          @if (employee.voterSection) {
          <div class="info-item">
            <label>Seção Eleitoral:</label>
            <span>{{ employee.voterSection }}</span>
          </div>
          }
          @if (employee.voterEmission) {
          <div class="info-item">
            <label>Data Emissão Título:</label>
            <span>{{ formatDate(employee.voterEmission) }}</span>
          </div>
          }
          @if (employee.militaryCertificate) {
          <div class="info-item">
            <label>Certificado Militar:</label>
            <span>{{ employee.militaryCertificate }}</span>
          </div>
          }
          @if (employee.driversLicense) {
          <div class="info-item">
            <label>Possui CNH:</label>
            <span>{{ employee.driversLicense ? 'Sim' : 'Não' }}</span>
          </div>
          }
          @if (employee.driversLicense && employee.driversLicenseNumber) {
          <div class="info-item">
            <label>Número CNH:</label>
            <span>{{ employee.driversLicenseNumber }}</span>
          </div>
          }
          @if (employee.driversLicense && employee.driversLicenseCategory) {
          <div class="info-item">
            <label>Categoria CNH:</label>
            <span>{{ employee.driversLicenseCategory }}</span>
          </div>
          }
          @if (employee.driversLicense && employee.driversLicenseEmissionDate) {
          <div class="info-item">
            <label>Data Emissão CNH:</label>
            <span>{{ formatDate(employee.driversLicenseEmissionDate) }}</span>
          </div>
          }
          @if (employee.driversLicense && employee.driversLicenseExpirationDate) {
          <div class="info-item">
            <label>Data Vencimento CNH:</label>
            <span>{{ formatDate(employee.driversLicenseExpirationDate) }}</span>
          </div>
          }
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Informações familiares -->
    @if (employee.fatherName || employee.motherName || employee.partnerName) {
    <mat-card class="info-section">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>family_restroom</mat-icon>
          Informações Familiares
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="info-grid">
          @if (employee.fatherName) {
          <div class="info-item">
            <label>Nome do Pai:</label>
            <span>{{ employee.fatherName }}</span>
          </div>
          }
          @if (employee.motherName) {
          <div class="info-item">
            <label>Nome da Mãe:</label>
            <span>{{ employee.motherName }}</span>
          </div>
          }
          @if (employee.partnerName) {
          <div class="info-item">
            <label>Nome do Cônjuge:</label>
            <span>{{ employee.partnerName }}</span>
          </div>
          }
          @if (employee.partnerCpf) {
          <div class="info-item">
            <label>CPF do Cônjuge:</label>
            <span>{{ formatCpf(employee.partnerCpf) }}</span>
          </div>
          }
          @if (employee.partnerBirthday) {
          <div class="info-item">
            <label>Data de Nascimento do Cônjuge:</label>
            <span>{{ formatDate(employee.partnerBirthday) }}</span>
          </div>
          }
          @if (employee.partnerRg) {
          <div class="info-item">
            <label>RG do Cônjuge:</label>
            <span>{{ employee.partnerRg }}</span>
          </div>
          }
        </div>
      </mat-card-content>
    </mat-card>
    }

    <!-- Informações Financeiras -->
    @if (employee.salary || employee.salaryBank || employee.familySalary) {
    <mat-card class="info-section">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>account_balance</mat-icon>
          Informações Financeiras
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="info-grid">
          @if (employee.salary) {
          <div class="info-item">
            <label>Salário:</label>
            <span>R$ {{ employee.salary | number:'1.2-2' }}</span>
          </div>
          }
          @if (employee.salaryBank) {
          <div class="info-item">
            <label>Banco:</label>
            <span>{{ employee.salaryBank }}</span>
          </div>
          }
          @if (employee.salaryAgency) {
          <div class="info-item">
            <label>Agência:</label>
            <span>{{ employee.salaryAgency }}</span>
          </div>
          }
          @if (employee.salaryAccount) {
          <div class="info-item">
            <label>Conta:</label>
            <span>{{ employee.salaryAccount }}</span>
          </div>
          }
          @if (employee.salaryAccountType) {
          <div class="info-item">
            <label>Tipo de Conta:</label>
            <span>{{ employee.salaryAccountType }}</span>
          </div>
          }
          @if (employee.familySalary) {
          <div class="info-item">
            <label>Salário Família:</label>
            <span>R$ {{ employee.familySalary | number:'1.2-2' }}</span>
          </div>
          }
          @if (employee.parenting) {
          <div class="info-item">
            <label>Parentesco:</label>
            <span>{{ employee.parenting }}</span>
          </div>
          }
          @if (employee.IRPF) {
          <div class="info-item">
            <label>IRPF:</label>
            <span>{{ employee.IRPF }}</span>
          </div>
          }
        </div>
      </mat-card-content>
    </mat-card>
    }

    <!-- Benefícios -->
    @if (employee.mealValue || employee.transport || employee.healthPlan || employee.deficiency) {
    <mat-card class="info-section">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>card_giftcard</mat-icon>
          Benefícios e Assistência
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="info-grid">
          @if (employee.mealValue) {
          <div class="info-item">
            <label>Valor Refeição:</label>
            <span>R$ {{ employee.mealValue | number:'1.2-2' }}</span>
          </div>
          }
          <div class="info-item">
            <label>Vale Transporte:</label>
            <span>{{ employee.transport ? 'Sim' : 'Não' }}</span>
          </div>
          @if (employee.transport && employee.trasportType) {
          <div class="info-item">
            <label>Tipo de Transporte:</label>
            <span>{{ employee.trasportType }}</span>
          </div>
          }
          @if (employee.transport && employee.transportValue) {
          <div class="info-item">
            <label>Valor Transporte:</label>
            <span>R$ {{ employee.transportValue | number:'1.2-2' }}</span>
          </div>
          }
          @if (employee.healthPlan) {
          <div class="info-item">
            <label>Plano de Saúde:</label>
            <span>{{ employee.healthPlan }}</span>
          </div>
          }
          @if (employee.healthCardNumber) {
          <div class="info-item">
            <label>Número Cartão Saúde:</label>
            <span>{{ employee.healthCardNumber }}</span>
          </div>
          }
          <div class="info-item">
            <label>Possui Deficiência:</label>
            <span>{{ employee.deficiency ? 'Sim' : 'Não' }}</span>
          </div>
          @if (employee.deficiency && employee.deficiencyDescription) {
          <div class="info-item full-width">
            <label>Descrição da Deficiência:</label>
            <span>{{ employee.deficiencyDescription }}</span>
          </div>
          }
        </div>
      </mat-card-content>
    </mat-card>
    }

    <!-- Informações Universitárias/Estágio -->
    @if (employee.college || employee.course || employee.ra || employee.traineeAddress) {
    <mat-card class="info-section">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>school</mat-icon>
          Informações Universitárias
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="info-grid">
          @if (employee.college) {
          <div class="info-item">
            <label>Faculdade:</label>
            <span>{{ employee.college }}</span>
          </div>
          }
          @if (employee.course) {
          <div class="info-item">
            <label>Curso:</label>
            <span>{{ employee.course }}</span>
          </div>
          }
          @if (employee.trainingPeriod) {
          <div class="info-item">
            <label>Período de Estágio:</label>
            <span>{{ employee.trainingPeriod }}</span>
          </div>
          }
          @if (employee.ra) {
          <div class="info-item">
            <label>RA:</label>
            <span>{{ employee.ra }}</span>
          </div>
          }
          @if (employee.traineeAddress) {
          <div class="info-item full-width">
            <label>Endereço da Faculdade:</label>
            <span>
              {{ employee.traineeAddress }}
              @if (employee.traineeAddressNumber) {
                , {{ employee.traineeAddressNumber }}
              }
              @if (employee.traineeAddressComplement) {
                , {{ employee.traineeAddressComplement }}
              }
              @if (employee.traineeAddressNeighborhood) {
                <br>{{ employee.traineeAddressNeighborhood }}
              }
              @if (employee.traineeAddressCity || employee.traineeAddressState) {
                <br>{{ employee.traineeAddressCity }}{{ employee.traineeAddressState ? ' - ' + employee.traineeAddressState : '' }}
              }
              @if (employee.collegeCep) {
                <br>CEP: {{ employee.collegeCep }}
              }
            </span>
          </div>
          }
          @if (employee.lifInsurancePolicy) {
          <div class="info-item">
            <label>Apólice Seguro de Vida:</label>
            <span>{{ employee.lifInsurancePolicy }}</span>
          </div>
          }
        </div>
      </mat-card-content>
    </mat-card>
    }

    <!-- Ações finais -->
    <div class="final-actions">
      <button mat-raised-button color="primary" (click)="generateBadge()">
        <mat-icon>badge</mat-icon>
        Gerar Crachá
      </button>
      <button mat-raised-button color="accent" (click)="generateDocument()">
        <mat-icon>description</mat-icon>
        Gerar Documento Contábil
      </button>
      <button mat-stroked-button color="primary" (click)="editEmployee()">
        <mat-icon>edit</mat-icon>
        Editar Funcionário
      </button>
      <button mat-button (click)="goBack()">
        <mat-icon>arrow_back</mat-icon>
        Voltar à Lista
      </button>
    </div>
  </div>
  }
</div>